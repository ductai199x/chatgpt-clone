@import "tailwindcss";
@plugin "@tailwindcss/typography";
@plugin "tailwindcss-animate";

@custom-variant dark (&:is(.dark *));

/* === Theme Variable Mapping === */
/* Maps semantic color names to CSS variables defined in :root/.dark */
@theme inline {
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);
  --color-destructive: var(--destructive);
  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);
  --color-sidebar: var(--sidebar);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-assistant: var(--assistant);
  --color-code-background: var(--code-background);
  --color-code-foreground: var(--code-foreground);
  --color-code-border: var(--code-border);
}

/* === Base Layer: Variables & Global Styles === */
@layer base {
  /* --- Light Mode Variables --- */
  :root {
    --radius: 0.625rem; /* 10px */

    --background: oklch(1 0 0); /* White */
    --foreground: oklch(0.145 0 0); /* Near Black */
    --card: oklch(1 0 0);
    --card-foreground: oklch(0.145 0 0);
    --popover: oklch(1 0 0);
    --popover-foreground: oklch(0.145 0 0);
    --primary: oklch(0.205 0 0); /* Dark Gray */
    --primary-foreground: oklch(0.985 0 0); /* Light Gray/White */
    --secondary: oklch(0.97 0 0); /* Very Light Gray */
    --secondary-foreground: oklch(0.205 0 0);
    --muted: oklch(0.97 0 0);
    --muted-foreground: oklch(0.556 0 0); /* Medium Gray */
    --accent: oklch(0.97 0 0);
    --accent-foreground: oklch(0.205 0 0);
    --destructive: oklch(0.577 0.245 27.325); /* Red */
    --destructive-foreground: oklch(0.985 0 0);
    --border: oklch(0.922 0 0); /* Light Gray Border */
    --input: oklch(0.922 0 0);
    --ring: oklch(0.708 0 0); /* Focus Ring */

    --sidebar: oklch(0.985 0 0); /* Slightly off-white */
    --sidebar-foreground: oklch(0.145 0 0);

    --assistant: oklch(0.97 0 0); /* Light gray for assistant messages */

    --code-background: oklch(0.97 0.01 240);
    --code-foreground: oklch(0.2 0 0);
    --code-border: oklch(0.9 0.01 240);

    --scrollbar-track: transparent;
    --scrollbar-thumb: oklch(0.6 0 0 / 30%);
    --scrollbar-thumb-hover: oklch(0.6 0 0 / 50%);
  }

  /* --- Dark Mode Variables --- */
  .dark {
    --background: #212121;
    --foreground: #ececf1;
    --card: #2f2f2f;
    --card-foreground: #ececf1;
    --popover: #2f2f2f;
    --popover-foreground: #ececf1;
    --primary: #ececf1; /* White for primary interactive elements */
    --primary-foreground: #212121; /* Dark text on primary */
    --secondary: #3e3f4b;
    --secondary-foreground: #ececf1;
    --muted: #3e3f4b;
    --muted-foreground: #8e8ea0;
    --accent: #4a6377;
    --accent-foreground: #bcccdc;
    --destructive: #ef4146; /* Red */
    --destructive-foreground: #ececf1;
    --border: rgba(255, 255, 255, 0.1); /* Subtle white border */
    --input: rgba(255, 255, 255, 0.08);
    --ring: #8e8ea0; /* Muted focus ring */
    --sidebar: #171717; /* Very dark sidebar */
    --sidebar-foreground: #ececf1;
    --assistant: #2f2f2f;
    --code-background: #171717;
    --code-foreground: #d1d5db;
    --code-border: rgba(255, 255, 255, 0.1);
    --scrollbar-track: transparent;
    --scrollbar-thumb: oklch(0.6 0 0 / 30%);
    --scrollbar-thumb-hover: oklch(0.6 0 0 / 50%);
  }

  /* --- Global Element Styles --- */
  * {
    @apply border-border outline-ring/50 box-border;
  }

  html,
  body {
    height: 100%;
    overflow: hidden; /* Prevent body scroll */
  }

  body {
    @apply bg-background text-foreground font-sans;
    /* Use a font stack similar to ChatGPT */
    font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont,
      "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif,
      "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
      "Noto Color Emoji";
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  ::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  ::-webkit-scrollbar-track {
    background: var(--scrollbar-track);
  }

  ::-webkit-scrollbar-thumb {
    background: var(--scrollbar-thumb);
    border-radius: 6px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: var(--scrollbar-thumb-hover);
  }
}

/* === Components Layer === */
@layer components {
  /* --- ChatMessage Component --- */
  .message-bubble {
    @apply py-5 px-4 md:px-0;
    /* Group class added in JSX for hover effects */
  }

  .message-bubble-content {
    @apply max-w-3xl mx-auto flex gap-4;
  }

  .message-icon {
    @apply flex-shrink-0 w-7 h-7 rounded-full flex items-center justify-center text-sm font-medium mt-0.5;
  }

  .message-icon.user {
    @apply bg-primary text-primary-foreground;
  }

  .message-icon.assistant {
    @apply bg-green-600 text-white; /* Consider making this themeable */
  }

  .message-main {
    @apply flex-grow min-w-0 space-y-2; /* Added space-y-2 */
  }

  .message-metadata {
    @apply flex items-center gap-2 text-sm font-semibold mb-1; /* Added mb-1 */
  }

  .message-metadata .role {
    @apply text-foreground;
  }

  .message-metadata .model,
  .message-metadata .timestamp {
    @apply text-muted-foreground text-xs;
  }

  .message-text-content {
    @apply text-foreground text-base leading-relaxed;
    /* Apply prose styles for markdown rendering */
    @apply prose prose-sm dark:prose-invert max-w-none prose-p:leading-relaxed prose-pre:p-0;
    /* Added prose styles */
  }

  .assistant .message-text-content {
    @apply bg-assistant p-3 rounded-md; /* Already exists */
  }

  .message-actions {
    @apply flex items-center gap-1 pl-5 mt-1; /* Indent to align with text, added mt-1 */
    @apply opacity-0 transition-opacity duration-100 text-muted-foreground;
    /* Hover effect applied via group-hover in JSX */
  }

  .message-actions button {
    @apply p-1 rounded-md hover:bg-accent hover:text-foreground;
    /* Specific overrides like text-destructive on hover are kept inline */
  }

  .message-version-nav {
    @apply flex items-center border border-border rounded-md p-0.5 mr-2; /* Added mr-2 */
  }

  .message-version-nav button {
    @apply p-0.5 disabled:opacity-30 disabled:cursor-not-allowed;
  }

  .message-version-nav button:first-child {
    @apply border-r border-border;
  }

  .message-version-nav button:last-child {
    @apply border-l border-border;
  }

  .message-version-nav span {
    @apply text-xs font-mono text-muted-foreground tabular-nums px-1.5;
  }

  .message-image-wrapper {
    @apply relative rounded-lg overflow-hidden my-2 max-w-[250px] border border-border;
  }

  .message-image {
    @apply block w-full h-auto object-contain;
  }

  .code-block {
    @apply my-0 rounded-lg overflow-hidden border border-code-border;
    background-color: var(--code-background);
  }

  .code-header {
    @apply flex justify-between items-center px-4 py-1.5 text-xs uppercase font-semibold rounded-t-lg;
    background-color: var(--muted);
    color: var(--muted-foreground);
    font-family: monospace;
    font-size: 0.8rem;
  }

  .code-header .language {
    @apply lowercase;
  }

  .code-header button {
    @apply flex items-center gap-1.5 text-xs hover:text-foreground p-1 -m-1 rounded;
    @apply opacity-0 transition-opacity; /* Base opacity */
    /* Hover effect applied via group-hover in JSX */
  }

  .code-block > div:nth-child(2) {
    /* Target the div wrapper from SyntaxHighlighter */
    @apply !px-6 !py-3 !m-0 rounded-2xl !bg-transparent;
    /* Ensure background comes from .code-block */
    color: var(--code-foreground);
    overflow-x: auto; /* Ensure horizontal scroll */
  }

  .typing-indicator {
    display: flex;
    gap: 4px;
    padding: 8px 0;
    align-items: center;
  }

  .typing-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background-color: var(--primary);
  }

  .animate-typing-dot-1 {
    animation: bounce 1s infinite -0.3s;
  }

  .animate-typing-dot-2 {
    animation: bounce 1s infinite -0.15s;
  }

  .animate-typing-dot-3 {
    animation: bounce 1s infinite;
  }

  .streaming-cursor {
    display: inline-block;
    width: 6px;
    height: 16px;
    background-color: currentColor;
    margin-left: 2px;
    animation: cursor-blink 1s infinite;
    vertical-align: middle;
  }

  .message-incomplete-indicator {
    @apply text-xs text-orange-500 ml-1;
  }

  .markdown-paragraph {
    @apply mb-2 last:mb-0;
  }

  /* --- Chat Interface --- */
  .chat-interface-container {
    @apply h-full relative flex flex-col overflow-hidden;
  }

  .chat-area-scroll-container {
    @apply absolute top-0 left-0 right-0 bottom-[0px] pb-[250px];
    @apply overflow-y-auto overflow-x-hidden;
    /* Ensure pointer events work for scrolling */
    pointer-events: auto;
    /* Force new stacking context without breaking scrolling */
    z-index: 10;
    /* Make sure we can scroll */
    touch-action: pan-y;
  }

  .chat-welcome-container {
    @apply h-full flex items-center justify-center;
  }

  .chat-messages-container {
    @apply max-w-5xl min-w-xl mx-auto px-4 pt-6 pb-4;
  }

  .chat-title-header {
    @apply flex justify-between items-center mb-4 sticky top-0 py-2 z-10;
    /* Blur background effect */
    @apply bg-background/80 backdrop-blur-sm;
    /* Negative margin + padding trick to extend backdrop to edges within the container's padding */
    @apply -mx-4 px-4;
  }

  .chat-title-text {
    @apply text-lg font-medium truncate flex-1 mr-2;
  }

  .chat-title-delete-button {
    @apply text-muted-foreground hover:text-destructive p-1 rounded-md flex-shrink-0;
  }

  .chat-input-area-inner {
    @apply max-w-3xl min-w-xl mx-auto;
  }

  /* --- MessageInput Component --- */
  .message-input-container {
    @apply relative rounded-xl border border-border border-t bg-background shadow-sm transition-colors duration-200;
    @apply focus-within:border-ring focus-within:ring-1 focus-within:ring-ring/50;
  }

  .message-input-container.drag-active {
    @apply border-primary ring-2 ring-primary/50;
  }

  .message-input-form {
    @apply p-2 space-y-2;
  }

  .message-input-previews {
    @apply flex flex-wrap gap-2 px-1 pt-1;
  }

  .message-input-preview-item {
    @apply relative w-16 h-16;
  }

  .message-input-preview-image {
    @apply w-full h-full object-cover rounded-md border border-border;
  }

  .message-input-preview-remove {
    @apply absolute -top-1.5 -right-1.5 w-4 h-4 bg-background border border-border text-muted-foreground rounded-full flex items-center justify-center opacity-0 transition-opacity cursor-pointer hover:bg-destructive hover:border-destructive;
  }

  .message-input-preview-remove:hover {
    @apply opacity-100;
    color: var(--destructive-foreground);
  }

  .message-input-row {
    @apply flex items-start gap-2;
  }

  .message-input-upload-button {
    @apply flex-shrink-0 text-muted-foreground hover:text-foreground h-10 w-10 flex items-center justify-center rounded-lg;
  }

  .message-input-send-button {
    @apply flex-shrink-0 h-10 w-10 rounded-lg flex items-center justify-center transition-colors;
    @apply bg-muted text-muted-foreground cursor-not-allowed; /* Default/disabled state */
  }

  .message-input-send-button:not(:disabled) {
    @apply bg-foreground text-background cursor-pointer hover:bg-foreground/80; /* Enabled state */
  }

  .message-input-send-button.streaming {
    @apply bg-green-600 hover:bg-green-700; /* Consider making themeable */
  }

  /* --- Slate Editor Styling --- */
  .slate-editor-wrapper {
    @apply flex-grow border border-input rounded-lg focus-within:ring-1 focus-within:ring-ring bg-background;
    /* Maintain overflow but with better positioning */
    @apply overflow-y-hidden relative;
    min-height: 65px;
    max-height: 200px;
  }

  .slate-editable {
    @apply px-3 py-2 text-sm outline-none leading-relaxed;
    @apply break-words overflow-y-auto overflow-x-hidden;
    min-height: 65px;
    max-height: 200px;
  }

  /* Placeholder styling for Slate */
  .slate-editable [data-slate-placeholder="true"] {
    color: var(--muted-foreground);
    opacity: 0.6;
    position: absolute;
    pointer-events: none;
    left: 12px; /* Align with padding-left */
    top: 8px !important; /* Align with padding-top */
    width: calc(100% - 24px); /* Prevent overflow */
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
  }

  /* Inline Artifact Pill within Slate Editor */
  .slate-editable .artifact-pill {
    @apply inline-flex items-center gap-1 bg-muted text-muted-foreground text-sm rounded px-2 py-0.5 mx-0.5 align-baseline;
    vertical-align: middle;
  }

  .slate-editable
    .artifact-pill[data-slate-selected="true"][data-slate-focused="true"] {
    @apply ring-2 ring-ring ring-offset-2 ring-offset-background;
  }

  .slate-editable .artifact-pill .pill-icon {
    @apply h-3.5 w-3.5 flex-shrink-0;
    color: inherit;
    opacity: 0.8;
  }

  .slate-editable .artifact-pill .pill-title {
    @apply truncate max-w-[150px] text-xs;
  }

  /* Scrollbar for the editable area */
  .slate-editable::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  .slate-editable::-webkit-scrollbar-track {
    background: var(--scrollbar-track);
    border-radius: 6px;
  }

  .slate-editable::-webkit-scrollbar-thumb {
    background: var(--scrollbar-thumb);
    border-radius: 6px;
  }

  .slate-editable::-webkit-scrollbar-thumb:hover {
    background: var(--scrollbar-thumb-hover);
  }

  /* --- Chat Interface Utilities --- */
  .scroll-to-bottom-button {
    @apply absolute bottom-36 left-1/2 transform -translate-x-1/2 z-10;
    @apply bg-background border border-border rounded-full p-2 shadow-lg;
    @apply hover:bg-accent transition-colors duration-150;
  }

  .scroll-to-bottom-button svg {
    @apply w-5 h-5 text-foreground;
  }

  .input-area-gradient {
    /* @apply fixed bottom-0 left-0 right-0; */
    @apply absolute bottom-0 left-0 right-0;
    /* Make sure input is above chat but doesn't block scrolling in chat */
    @apply z-20;
    @apply bg-gradient-to-t from-background via-background/65 to-transparent;
    @apply pt-4 pb-2 md:pb-4;
    /* Use min-height for flexible expansion */
    min-height: 140px;
    max-height: 300px;
    overflow-y: auto;
  }

  .input-footer-text {
    @apply text-xs text-muted-foreground text-center mt-2 px-2;
  }

  .chat-error-message {
    @apply mt-4 text-destructive text-sm p-3 rounded-md bg-destructive/10 border border-destructive/30;
  }

  /* --- Artifact Placeholder Button (in ChatMessage) --- */
  .artifact-placeholder {
    @apply border-border bg-muted/50 hover:bg-muted;
  }

  .artifact-placeholder span {
    @apply whitespace-nowrap;
  }

  /* --- ArtifactDisplay Component Styles --- */
  .artifact-loading-placeholder {
    @apply my-2 p-2 border rounded-md bg-muted text-muted-foreground text-sm flex items-center justify-between opacity-50 cursor-not-allowed;
  }

  .artifact-display-container {
    @apply my-2 w-full justify-start h-auto py-1.5 px-3; /* Base layout */
    @apply inline-flex items-center relative; /* Flex & positioning */
    @apply border rounded-md bg-background hover:bg-muted; /* Appearance */
    @apply text-sm cursor-pointer transition-colors; /* Text & interaction */
  }

  .artifact-display-main {
    @apply flex items-center flex-grow min-w-0 mr-2; /* Icon + Title section, allows shrinking */
  }

  .artifact-display-title {
    @apply flex-grow text-left truncate mr-2; /* Allow title to take space and truncate */
  }

  .artifact-display-streaming {
    @apply text-xs text-muted-foreground mr-2 flex-shrink-0; /* Prevent streaming text from wrapping */
  }

  .artifact-display-actions {
    @apply flex items-center gap-1 flex-shrink-0; /* Action buttons section */
  }

  .artifact-display-reference-button {
    /* Style for the reference button - keep .artifact-reference-button for JS */
    @apply p-1 rounded hover:bg-accent focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring;
  }

  /* --- Artifact Sidebar Scrollbar --- */
  .artifact-sidebar-scrollarea::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  .artifact-sidebar-scrollarea::-webkit-scrollbar-track {
    background: var(--scrollbar-track);
  }

  .artifact-sidebar-scrollarea::-webkit-scrollbar-thumb {
    background: var(--scrollbar-thumb);
    border-radius: 6px;
  }

  .artifact-sidebar-scrollarea::-webkit-scrollbar-thumb:hover {
    background: var(--scrollbar-thumb-hover);
  }

  /* --- Artifact Sidebar --- */
  .artifact-sidebar-container {
    @apply fixed inset-y-0 right-0 z-40 bg-background border-l border-border shadow-lg;
    @apply flex flex-col w-full; /* Mobile first: full width */
    /* Default transition for open/close (transform) and resize completion (width) */
    @apply transition-transform duration-200 ease-in-out; /* Keep transform transition */
    /* Add width transition here for when resizing finishes */
    transition-property: transform, width;
    transition-duration: 200ms;
    transition-timing-function: ease-in-out;
  }

  .artifact-sidebar-header {
    @apply flex items-center justify-between p-3 border-b border-border shrink-0 h-14 gap-2;
  }

  .artifact-sidebar-header-title-section {
    @apply flex items-center truncate mr-1;
  }

  .artifact-sidebar-header-icon {
    @apply h-4 w-4 mr-2 shrink-0;
  }

  .artifact-sidebar-header-title {
    @apply font-medium truncate;
  }

  .artifact-sidebar-header-streaming {
    @apply text-xs text-muted-foreground ml-2 animate-pulse;
  }

  .artifact-sidebar-header-actions-section {
    @apply flex items-center gap-1 shrink-0;
  }

  .artifact-sidebar-version-switcher {
    @apply flex items-center gap-0.5 border border-border rounded-md p-0.5 mr-1;
  }

  .artifact-sidebar-version-switcher-button {
    /* Using Button component variant/size, but could add base styles if needed */
    @apply h-6 w-6; /* Example override if needed */
  }

  .artifact-sidebar-version-switcher-text {
    @apply text-xs font-medium text-muted-foreground tabular-nums px-1;
  }

  .artifact-sidebar-action-button {
    /* Using Button component variant/size, but could add base styles if needed */
    @apply h-8 w-8; /* Example override if needed */
  }

  .artifact-sidebar-content-area {
    @apply flex-grow overflow-hidden;
  }

  .artifact-sidebar-loading-state,
  .artifact-sidebar-empty-state {
    @apply p-4 text-center text-muted-foreground;
  }

  .artifact-sidebar-editor-scrollarea {
    @apply h-full p-4;
  }

  .artifact-sidebar-editor-textarea {
    /* Using Textarea component, apply overrides here if needed */
    @apply w-full h-[calc(100vh-150px)] resize-none font-mono text-sm border rounded-md p-2;
  }

  .artifact-sidebar-resizer {
    @apply absolute left-0 top-0 bottom-0 z-50 w-1.5 cursor-col-resize;
    @apply hidden md:block;
    @apply bg-transparent hover:bg-blue-500/30 transition-colors duration-200;
    touch-action: none;
  }

  .artifact-sidebar-container.is-resizing {
    transition-property: transform !important;
  }

  /* --- Artifact Content Renderers --- */
  .artifact-content-code {
    @apply p-4 pb-10; /* Padding for code content */
  }

  .artifact-content-html {
    @apply p-4; /* Padding for HTML content */
  }

  .artifact-content-html-iframe {
    @apply w-full h-[calc(100vh-150px)] border-none rounded bg-white;
  }

  .artifact-content-default {
    /* Using <pre> for formatting */
    @apply p-4 text-sm whitespace-pre-wrap break-words;
  }

  .artifact-content-empty-text {
    @apply text-muted-foreground; /* Style for "(Empty)" text */
  }

  /* --- Mobile Header --- */
  .mobile-header {
    @apply flex items-center justify-between px-3 py-2 border-b border-border md:hidden;
  }

  .mobile-header-title {
    @apply text-base font-medium truncate max-w-[200px];
  }

  .mobile-header-button {
    @apply text-muted-foreground hover:text-foreground;
  }

  /* --- Sidebar --- */
  .sidebar {
    @apply fixed inset-y-0 left-0 z-50 flex h-full w-64 flex-col border-r border-border bg-sidebar text-sidebar-foreground transition-transform duration-300 ease-in-out;
  }

  .sidebar-backdrop {
    @apply fixed inset-0 z-40 bg-black/50 transition-opacity duration-300 ease-in-out md:hidden;
  }

  .sidebar-open-button {
    @apply fixed bottom-4 right-4 z-50 flex h-12 w-12 items-center justify-center rounded-full bg-primary text-primary-foreground shadow-lg md:hidden;
  }

  .sidebar-desktop-trigger {
    @apply fixed inset-y-0 left-0 z-40 w-4 cursor-pointer;
  }

  .sidebar-header {
    @apply flex h-14 items-center justify-end border-b border-border p-2 shrink-0;
  }

  .sidebar-new-chat-button-header {
    @apply h-8 w-8 text-muted-foreground hover:text-foreground hover:bg-muted ml-auto;
  }

  .sidebar-close-button {
    @apply h-8 w-8 text-muted-foreground hover:text-foreground hover:bg-muted mr-2;
  }

  .sidebar-nav {
    @apply flex-1 overflow-y-auto px-2 py-2;
  }

  .sidebar-nav ul {
    @apply list-none p-0 m-0 space-y-1;
  }

  .sidebar-item-container {
    @apply flex items-center relative rounded-md;
  }

  .sidebar-item-button {
    @apply w-full justify-center text-sm flex flex-col items-start gap-0 overflow-hidden h-auto px-2 py-1.5;
    @apply text-sidebar-foreground hover:bg-accent/50 rounded-md;
  }

  .sidebar-item-button.active {
    @apply bg-accent text-accent-foreground;
  }

  .sidebar-item-title-row {
    @apply flex items-center w-full;
  }

  .sidebar-item-title {
    @apply truncate flex-1 text-left text-sm;
  }

  .sidebar-item-date {
    /* Indented to align below title, assuming no icon */
    @apply text-xs text-muted-foreground/80 w-full text-left mt-0.5;
    /* If an icon is present in title-row, adjust padding-left here */
    /* @apply pl-6; */
  }

  .sidebar-item-actions {
    /* Positioned absolutely within the container for hover reveal */
    @apply absolute right-1 top-1/2 transform -translate-y-1/2 flex items-center;
    @apply opacity-0 transition-opacity duration-150;
    /* Make actions visible on container hover */
    .sidebar-item-container:hover & {
      @apply opacity-100;
    }
  }

  .sidebar-item-delete-button {
    @apply h-7 w-7 p-0 text-muted-foreground hover:text-destructive hover:bg-destructive/10;
  }

  .sidebar-empty-list {
    @apply text-sm text-muted-foreground px-2 py-4 text-center;
  }

  .sidebar-footer {
    @apply p-2 border-t border-border/50 flex flex-col gap-1;
  }

  .sidebar-footer-button {
    @apply w-full justify-start text-sm h-9 px-2 rounded-md;
    @apply text-sidebar-foreground hover:bg-accent/50;
  }

  /* Shadcn UI Switch adjustments for better contrast/visibility */
  [role="switch"] {
    /* Add border in unchecked state using input border color */
    @apply data-[state=unchecked]:border data-[state=unchecked]:border-input;
    /* Use muted background for unchecked state */
    @apply data-[state=unchecked]:bg-muted;
  }

  [role="switch"] > span {
    /* Use muted-foreground for unchecked thumb */
    @apply data-[state=unchecked]:bg-muted-foreground;
    /* Use primary-foreground for checked thumb (contrast against primary track) */
    @apply data-[state=checked]:bg-primary-foreground;
  }

  /* --- Settings Dialog --- */
  .settings-dialog-content {
    @apply p-6 sm:p-8 max-h-[80dvh] overflow-y-scroll; /* Allow scrolling */
  }

  .settings-tabs-list {
    @apply grid w-full grid-cols-3 mb-6 gap-1.5 rounded-lg bg-muted p-1;
  }

  .settings-tabs-trigger {
    @apply w-full inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1.5 text-sm font-medium ring-offset-background transition-all;
    @apply focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2;
    @apply disabled:pointer-events-none disabled:opacity-50;
    @apply bg-transparent text-muted-foreground hover:text-foreground;
    /* Active tab uses dialog background for contrast */
    @apply data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm;
  }

  .settings-tabs-content {
    @apply mt-4 space-y-6 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2;
  }

  /* --- Settings Sections --- */
  .settings-section {
    @apply space-y-4 rounded-lg border border-border p-4;
  }

  .settings-section-header {
    @apply text-base font-semibold leading-none tracking-tight mb-4;
  }

  .settings-item {
    @apply space-y-1.5;
  }

  /* Add margin below labels for spacing */
  .settings-item > label,
  .settings-item-label-desc > label {
    @apply block mb-3;
  }

  .settings-item-row {
    @apply flex items-center justify-between space-x-4;
  }

  .settings-item-label-desc {
    @apply space-y-0.5 flex-1;
  }

  .settings-item-control {
    @apply flex-shrink-0;
  }

  .settings-item-description {
    @apply text-sm text-muted-foreground pt-1;
  }

  /* --- API Key Input Specific --- */
  .api-key-input-wrapper {
    @apply flex items-center gap-2;
  }

  .api-key-input-container {
    @apply flex-1;
  }

  .api-key-input {
    @apply w-full;
  }

  .api-key-validation-icon {
    @apply h-5 w-5 flex-shrink-0;
  }

  .api-key-toggle-button {
    @apply text-muted-foreground hover:text-foreground flex-shrink-0;
  }

  /* Input Validation state styles */
  .input-valid {
    @apply border-green-500 focus-visible:ring-green-500/50;
  }

  .input-invalid {
    @apply border-destructive focus-visible:ring-destructive/50;
  }

  .text-valid {
    @apply text-green-600 dark:text-green-500;
  }

  .text-invalid {
    @apply text-destructive;
  }

  /* === Artifact/Code Block Line Number Styles === */
  /* Applied to the container holding the <pre> or <code> */
  .artifact-code-block code {
    display: block;
    white-space: pre-wrap;
    word-break: break-word;
  }

  .artifact-code-block.has-line-numbers {
    overflow-x: auto;
  }

  .code-lines-container {
    display: block; /* Or 'table' if using table layout */
  }

  .code-line {
    display: flex;
    align-items: flex-start; /* Align number top-left with content */
    line-height: 1.4; /* Match syntax highlighter */
    min-height: 1.4em;
  }

  .line-number {
    display: inline-block;
    text-align: right;
    padding-right: 1em;
    margin-right: 0.5em;
    min-width: 2.5em; /* Adjust as needed for max line number width */
    color: #888; /* Muted color for line numbers */
    user-select: none;
    font-size: 0.9em;
    /* Optional: border-right: 1px solid #444; */
  }

  .line-content {
    display: inline-block;
    flex-grow: 1;
    white-space: pre-wrap; /* Allow wrapping within the line */
    word-break: break-all; /* Break long words if necessary */
  }

  /* --- Welcome Screen --- */
  .welcome-screen-container {
    @apply flex flex-col items-center justify-center min-h-[calc(100vh-12rem)] py-8 px-4 text-center;
  }

  .welcome-screen-title {
    @apply text-4xl font-bold mb-2;
  }

  .welcome-screen-subtitle {
    @apply text-muted-foreground mb-8;
  }

  .welcome-screen-section {
    @apply w-full max-w-md mb-8; /* Common section styling */
  }

  .welcome-screen-section-title {
    @apply text-lg font-medium mb-4;
  }

  .welcome-screen-grid {
    @apply grid gap-3;
  }

  .welcome-screen-example-button {
    @apply justify-between text-sm font-normal h-auto py-3 px-4;
  }

  .welcome-screen-example-button-text {
    @apply text-left;
  }

  .welcome-screen-example-button-icon {
    @apply h-4 w-4 ml-2 shrink-0;
  }

  .welcome-screen-capability-item {
    @apply border border-border rounded-lg p-3 text-sm text-left;
  }
}

/* === Animation Keyframes === */
@keyframes cursor-blink {
  0%,
  100% {
    opacity: 1;
  }
  50% {
    opacity: 0;
  }
}

@keyframes bounce {
  0%,
  80%,
  100% {
    transform: translateY(0);
  }
  40% {
    transform: translateY(-6px);
  }
}
